{"version":3,"sources":["history.js","services/urlManagement.service.js","layers/index.js","services/controls.service.js","Components/controlOption.js","Components/Controller.js","App.js","serviceWorker.js","index.js"],"names":["history","createBrowserHistory","controller","mapUrlToProps","url","props","showParking","decode","UrlQueryParamTypes","boolean","cp","showBikeTraffic","bt","extrudeBikeTraffic","xbt","showCarTraffic","ct","extrudeCarTraffic","xct","showEvCharging","evc","menuOpen","m","showBusStops","bs","showFerryStops","fs","showMetroStops","ms","showRailStops","rs","showShipStops","ss","showTramStops","ts","mapUrlChangeHandlersToProps","onChange","value","replaceInUrlQuery","encode","controllerUrlManager","addUrlProps","map","longitude","number","lng","latitude","lat","zoom","z","pitch","p","bearing","b","toFixed","mapUrlManager","parkingLayer","busStopLayer","carFerryStopLayer","bikeTrafficLayer","carTrafficLayer","evChargingLayer","metroStationLayer","railStationLayer","ferryStopLayer","tramStationLayer","stockholmAreaLayers","__webpack_require__","e","then","bind","layer","default","layers","layerLoaded","animate","requestAnimationFrame","TWEEN","update","onLayerLoaded","cb","setLayers","layerSettings","_bikeTrafficHeight","_carTrafficHeight","toolTipCallback","animateLayer","setHeight","extrude","height","target","Tween","to","easing","Easing","Quadratic","InOut","onUpdate","start","controls_service","label","ref","key","heightKey","dep","controlOption","controlSettings","toggleLayer","i","react_default","a","createElement","className","Checkbox","type","defaultChecked","_ref","checked","Object","objectSpread","Controller","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","_updateLayers","visibleLayers","onLayerChange","_toggleLayer","newState","v","setTimeout","controlOptions","controls","_this2","listen","forceUpdate","_this3","BurgerMenu","width","right","noOverlay","disableOverlayClick","isOpen","onStateChange","state","option","settings","React","Component","defaultProps","isMobile","App","_onWebGLInitialized","gl","enable","DEPTH_TEST","depthFunc","LEQUAL","setState","_onLayerChange","mapLayers","_toolTipCallback","info","hoveredObject","object","pointerX","x","pointerY","y","style","position","zIndex","pointerEvents","left","top","color","backgroundColor","fontFamily","padding","message","viewState","_ref2","console","log","clearTimeout","urlTimer","document","getElementById","addEventListener","evt","preventDefault","_this4","id","esm","_deck","deck","onWebGLInitialized","initialViewState","onViewStateChange","viewport","_updateUrl","dist_esm","_map","getMap","mapboxApiAccessToken","process","onLoad","_onMapLoad","mapStyle","preventStyleDiffing","_renderTooltip","Components_Controller","href","rel","Boolean","window","location","hostname","match","configureUrlQuery","ReactDOM","render","src_App_0","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.50d44680.chunk.js","sourcesContent":["import { createBrowserHistory } from 'history';\r\n\r\nconst history = createBrowserHistory();\r\n\r\nexport default history;","import {\r\n  addUrlProps,\r\n  UrlQueryParamTypes,\r\n  replaceInUrlQuery,\r\n  decode,\r\n  encode\r\n} from \"react-url-query\";\r\n\r\nconst controller = {\r\n\r\n  mapUrlToProps: (url, props) => {\r\n    return {\r\n      showParking: decode(UrlQueryParamTypes.boolean, url.cp),\r\n      showBikeTraffic: decode(UrlQueryParamTypes.boolean, url.bt),\r\n      extrudeBikeTraffic: decode(UrlQueryParamTypes.boolean, url.xbt),\r\n      showCarTraffic: decode(UrlQueryParamTypes.boolean, url.ct),\r\n      extrudeCarTraffic: decode(UrlQueryParamTypes.boolean, url.xct),\r\n      showEvCharging: decode(UrlQueryParamTypes.boolean, url.evc),\r\n      menuOpen: decode(UrlQueryParamTypes.boolean, url.m),\r\n      showBusStops: decode(UrlQueryParamTypes.boolean, url.bs),\r\n      showFerryStops: decode(UrlQueryParamTypes.boolean, url.fs),\r\n      showMetroStops: decode(UrlQueryParamTypes.boolean, url.ms),\r\n      showRailStops: decode(UrlQueryParamTypes.boolean, url.rs),\r\n      showShipStops: decode(UrlQueryParamTypes.boolean, url.ss),\r\n      showTramStops: decode(UrlQueryParamTypes.boolean, url.ts)\r\n    };\r\n  },\r\n\r\n  mapUrlChangeHandlersToProps: (props) => {\r\n    return {\r\n      onChange: value => {\r\n        replaceInUrlQuery(\r\n          \"cp\",\r\n          encode(UrlQueryParamTypes.boolean, value.showParking)\r\n        );\r\n        replaceInUrlQuery(\r\n          \"bt\",\r\n          encode(UrlQueryParamTypes.boolean, value.showBikeTraffic)\r\n        );\r\n        replaceInUrlQuery(\r\n          \"xbt\",\r\n          encode(UrlQueryParamTypes.boolean, value.extrudeBikeTraffic)\r\n        );\r\n        replaceInUrlQuery(\r\n          \"ct\",\r\n          encode(UrlQueryParamTypes.boolean, value.showCarTraffic)\r\n        );\r\n        replaceInUrlQuery(\r\n          \"xct\",\r\n          encode(UrlQueryParamTypes.boolean, value.extrudeCarTraffic)\r\n        );\r\n        replaceInUrlQuery(\r\n          \"evc\",\r\n          encode(UrlQueryParamTypes.boolean, value.showEvCharging)\r\n        );\r\n        replaceInUrlQuery(\r\n          \"m\",\r\n          encode(UrlQueryParamTypes.boolean, value.menuOpen)\r\n        );\r\n        replaceInUrlQuery(\r\n          \"bs\",\r\n          encode(UrlQueryParamTypes.boolean, value.showBusStops)\r\n        );\r\n        replaceInUrlQuery(\r\n          \"fs\",\r\n          encode(UrlQueryParamTypes.boolean, value.showFerryStops)\r\n        );\r\n        replaceInUrlQuery(\r\n          \"ms\",\r\n          encode(UrlQueryParamTypes.boolean, value.showMetroStops)\r\n        );\r\n        replaceInUrlQuery(\r\n          \"rs\",\r\n          encode(UrlQueryParamTypes.boolean, value.showRailStops)\r\n        );\r\n        replaceInUrlQuery(\r\n          \"ss\",\r\n          encode(UrlQueryParamTypes.boolean, value.showShipStops)\r\n        );\r\n        replaceInUrlQuery(\r\n          \"ts\",\r\n          encode(UrlQueryParamTypes.boolean, value.showTramStops)\r\n        );\r\n      }\r\n    };\r\n  }\r\n\r\n}\r\n\r\nconst controllerUrlManager = addUrlProps({\r\n  mapUrlToProps: controller.mapUrlToProps,\r\n  mapUrlChangeHandlersToProps: controller.mapUrlChangeHandlersToProps\r\n})\r\n\r\nconst map = {\r\n\r\n  mapUrlToProps: (url, props) => {\r\n    return {\r\n      longitude: decode(UrlQueryParamTypes.number, url.lng) || 18.0686,\r\n      latitude: decode(UrlQueryParamTypes.number, url.lat) || 59.3293,\r\n      zoom: decode(UrlQueryParamTypes.number, url.z) || 13,\r\n      pitch: decode(UrlQueryParamTypes.number, url.p) || 45,\r\n      bearing: decode(UrlQueryParamTypes.number, url.b) || 0\r\n    };\r\n  },\r\n\r\n  mapUrlChangeHandlersToProps: (props) => {\r\n    return {\r\n      onChange: value => {\r\n        replaceInUrlQuery(\r\n          \"lng\",\r\n          encode(UrlQueryParamTypes.number, value.longitude)\r\n        );\r\n        replaceInUrlQuery(\r\n          \"lat\",\r\n          encode(UrlQueryParamTypes.number, value.latitude)\r\n        );\r\n        replaceInUrlQuery(\r\n          \"z\",\r\n          encode(UrlQueryParamTypes.number, value.zoom.toFixed(1))\r\n        );\r\n        replaceInUrlQuery(\r\n          \"p\",\r\n          encode(UrlQueryParamTypes.number, value.pitch.toFixed(1))\r\n        );\r\n        replaceInUrlQuery(\r\n          \"b\",\r\n          encode(UrlQueryParamTypes.number, value.bearing.toFixed(1))\r\n        );\r\n      }\r\n    };\r\n  }\r\n\r\n}\r\n\r\nconst mapUrlManager = addUrlProps({\r\n  mapUrlToProps: map.mapUrlToProps,\r\n  mapUrlChangeHandlersToProps: map.mapUrlChangeHandlersToProps\r\n})\r\n\r\nexport {\r\n  controllerUrlManager,\r\n  mapUrlManager\r\n}","import TWEEN from \"@tweenjs/tween.js\";\n\n// import parkingLayer from './parkingLayer'\n// import busStopLayer from './busStopLayer'\n// import carFerryStopLayer from './carFerryStopLayer'\n// import bikeTrafficLayer from './bikeTrafficLayer'\n// import carTrafficLayer from './carTrafficLayer'\n// import evChargingLayer from './evChargingLayer'\n// import metroStationLayer from './metroStationLayer'\n// import railStationLayer from './railStationLayer'\n// import ferryStopLayer from './ferryStopLayer'\n// import tramStationLayer from './tramStationLayer'\n// import busCoverageLayer from './busCoverageLayer'\n\nlet parkingLayer = () => {};\nlet busStopLayer = () => {};\nlet carFerryStopLayer = () => {};\nlet bikeTrafficLayer = () => {};\nlet carTrafficLayer = () => {};\nlet evChargingLayer = () => {};\nlet metroStationLayer = () => {};\nlet railStationLayer = () => {};\nlet ferryStopLayer = () => {};\nlet tramStationLayer = () => {};\nlet stockholmAreaLayers = () => {};\n\nimport(\"./parkingLayer\").then(layer => {\n  parkingLayer = layer.default;\n  layers.layerLoaded();\n});\nimport(\"./busStopLayer\").then(layer => {\n  busStopLayer = layer.default;\n  layers.layerLoaded();\n});\nimport(\"./carFerryStopLayer\").then(layer => {\n  carFerryStopLayer = layer.default;\n  layers.layerLoaded();\n});\nimport(\"./bikeTrafficLayer\").then(layer => {\n  bikeTrafficLayer = layer.default;\n  layers.layerLoaded();\n});\nimport(\"./carTrafficLayer\").then(layer => {\n  carTrafficLayer = layer.default;\n  layers.layerLoaded();\n});\nimport(\"./evChargingLayer\").then(layer => {\n  evChargingLayer = layer.default;\n  layers.layerLoaded();\n});\nimport(\"./metroStationLayer\").then(layer => {\n  metroStationLayer = layer.default;\n  layers.layerLoaded();\n});\nimport(\"./railStationLayer\").then(layer => {\n  railStationLayer = layer.default;\n  layers.layerLoaded();\n});\nimport(\"./ferryStopLayer\").then(layer => {\n  ferryStopLayer = layer.default;\n  layers.layerLoaded();\n});\nimport(\"./tramStationLayer\").then(layer => {\n  tramStationLayer = layer.default;\n  layers.layerLoaded();\n});\nimport(\"./stockholmAreaLayers\").then(layer => {\n  stockholmAreaLayers = layer.default;\n  layers.layerLoaded();\n});\n\n// layerFiles.forEach(lf => {\n//   import(lf).then(layer => {\n//     allLayers.push(layer.default)\n//     console.log('al', allLayers)\n//   })\n// })\n\nfunction animate() {\n  requestAnimationFrame(animate);\n  TWEEN.update();\n}\n\nanimate();\n\nconst layers = {\n  layerLoaded() {},\n\n  onLayerLoaded(cb) {\n    layers.layerLoaded = cb;\n  },\n\n  setLayers(layerSettings) {\n    return [\n      parkingLayer(layerSettings.showParking),\n      bikeTrafficLayer(\n        layerSettings.showBikeTraffic,\n        layerSettings._bikeTrafficHeight\n      ),\n      carTrafficLayer(\n        layerSettings.showCarTraffic,\n        layerSettings._carTrafficHeight\n      ),\n      evChargingLayer(\n        layerSettings.showEvCharging,\n        layerSettings.toolTipCallback\n      ),\n      busStopLayer(layerSettings.showBusStops),\n      carFerryStopLayer(layerSettings.showFerryStops),\n      metroStationLayer(layerSettings.showMetroStops),\n      railStationLayer(layerSettings.showRailStops),\n      ferryStopLayer(layerSettings.showShipStops),\n      tramStationLayer(layerSettings.showTramStops),\n      stockholmAreaLayers\n    ];\n  },\n\n  animateLayer(setHeight, extrude, cb) {\n    let height = { value: extrude ? 0.01 : 1 },\n      target = extrude ? 1 : 0.01;\n\n    new TWEEN.Tween(height)\n      .to({ value: target }, 500)\n      .easing(TWEEN.Easing.Quadratic.InOut)\n      .onUpdate(() => {\n        setHeight(height.value);\n        cb();\n      })\n      .start();\n  }\n};\n\nexport {\n  parkingLayer,\n  busStopLayer,\n  bikeTrafficLayer,\n  carTrafficLayer,\n  evChargingLayer,\n  carFerryStopLayer,\n  metroStationLayer,\n  railStationLayer,\n  ferryStopLayer,\n  tramStationLayer\n};\n\nexport default layers;\n","export default [\r\n  {\r\n    label: \"Parking\",\r\n    ref: \"parkingCheck\",\r\n    key: \"showParking\"\r\n  },\r\n  {\r\n    label: \"Bicycle Traffic\",\r\n    ref: \"bikeTrafficCheck\",\r\n    key: \"showBikeTraffic\"\r\n  },\r\n  {\r\n    label: \"3D Bicycle Traffic\",\r\n    ref: \"bikeExtrudeCheck\",\r\n    key: \"extrudeBikeTraffic\",\r\n    animate: true,\r\n    heightKey: \"_bikeTrafficHeight\",\r\n    dep: \"showBikeTraffic\"\r\n  },\r\n  {\r\n    label: \"Vehicle Traffic\",\r\n    ref: \"carTrafficCheck\",\r\n    key: \"showCarTraffic\"\r\n  },\r\n  {\r\n    label: \"3D Vehicle Traffic\",\r\n    ref: \"carTrafficCheck\",\r\n    key: \"extrudeCarTraffic\",\r\n    heightKey: \"_carTrafficHeight\",\r\n    animate: true,\r\n    dep: \"showCarTraffic\"\r\n  },\r\n  {\r\n    label: \"Electric Vehicle Charging Stations\",\r\n    ref: \"evChargingCheck\",\r\n    key: \"showEvCharging\"\r\n  },\r\n  {\r\n    label: \"Bus Stops\",\r\n    ref: \"busStopCheck\",\r\n    key: \"showBusStops\"\r\n  },\r\n  {\r\n    label: \"Metro Stations\",\r\n    ref: \"metroStopCheck\",\r\n    key: \"showMetroStops\"\r\n  },\r\n  {\r\n    label: \"Railway Stations\",\r\n    ref: \"railStopCheck\",\r\n    key: \"showRailStops\"\r\n  },\r\n  {\r\n    label: \"Ferry Stops\",\r\n    ref: \"shipStopCheck\",\r\n    key: \"showShipStops\"\r\n  },\r\n  {\r\n    label: \"Tram Stations\",\r\n    ref: \"tramStopCheck\",\r\n    key: \"showTramStops\"\r\n  },\r\n  {\r\n    label: \"Car Ferry Stops\",\r\n    ref: \"ferryStopCheck\",\r\n    key: \"showFerryStops\"\r\n  }\r\n];\r\n","import React from \"react\";\r\nimport { Checkbox } from \"semantic-ui-react\";\r\n\r\nconst controlOption = (props, controlSettings, toggleLayer, i) => {\r\n  return (\r\n    <div className={\r\n      \"controller-option \" +\r\n      ( controlSettings.dep ? 'option-secondary-checkbox ' : '' ) +\r\n      ( controlSettings.dep && !props[ controlSettings.dep ] ? 'disabled' : '' )\r\n    } key={ i }>\r\n      <Checkbox\r\n        label={ controlSettings.label }\r\n        ref={ controlSettings.ref }\r\n        type=\"checkbox\"\r\n        defaultChecked={ props[ controlSettings.key ] }\r\n        onChange={ (e, { checked }) => toggleLayer({\r\n          ...controlSettings,\r\n          checked\r\n        }) }\r\n      />\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default controlOption;","import React from \"react\";\n\nimport history from \"../history\";\nimport layers from \"../layers\";\n\nimport controls from '../services/controls.service'\nimport controlOption from './controlOption'\nimport { controllerUrlManager } from '../services/urlManagement.service'\n\nimport \"../Controller.css\";\n\nimport { slide as Menu } from \"react-burger-menu\";\nimport { isMobile } from \"react-device-detect\";\n\nclass Controller extends React.Component {\n  static defaultProps = {\n    showParking: false,\n    showBikeTraffic: true,\n    extrudeBikeTraffic: true,\n    showCarTraffic: !isMobile,\n    extrudeCarTraffic: false,\n    showEvCharging: true,\n    menuOpen: !isMobile,\n    onLayerChange: () => {},\n    showBusStops: true,\n    showFerryStops: true,\n    showMetroStops: true,\n    showRailStops: true,\n    showShipStops: true,\n    showTramStops: true\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.controlOptions = controls;\n\n    this._bikeTrafficHeight = props.extrudeBikeTraffic ? 1 : 0.01;\n    this._carTrafficHeight = props.extrudeCarTraffic ? 1 : 0.01;\n\n  }\n\n  componentDidMount() {\n    this._updateLayers();\n\n    history.listen(() => this.forceUpdate());\n\n    layers.onLayerLoaded(() => this._updateLayers());\n  }\n\n  _updateLayers = () => {\n    const layerSettings = {\n      ...this.props,\n      _bikeTrafficHeight: this._bikeTrafficHeight,\n      _carTrafficHeight: this._carTrafficHeight\n    }\n\n    const visibleLayers = layers.setLayers( layerSettings );\n\n    this.props.onLayerChange( visibleLayers );\n  };\n\n  _toggleLayer = ({ checked, key, animate, heightKey }) => {\n    let newState = { ...this.props };\n    newState[ key ] = checked;\n\n    if( animate && heightKey ) {\n      layers.animateLayer(\n        v => ( this[ heightKey ] = v ),\n        checked,\n        () => this._updateLayers()\n      );\n    }\n\n    this.props.onChange( newState );\n\n    setTimeout(this._updateLayers, 0);\n  }\n\n  render() {\n    return (\n      <Menu\n        width={200}\n        className={\"controller-container\"}\n        right\n        noOverlay\n        disableOverlayClick\n        isOpen={this.props.menuOpen}\n        onStateChange={state =>\n          this.props.onChange({ ...this.props, menuOpen: state.isOpen })\n        }\n      >\n        <h3>Stockholm Sustainable Traffic Planning</h3>\n        <p>Toggle the checkboxes below to turn layers on&nbsp;and&nbsp;off</p>\n\n        {\n          this.controlOptions.map((option, i) => {\n            return controlOption(\n              this.props,\n              option,\n              (settings) => { this._toggleLayer(settings) },\n              i\n            )\n          })\n        }\n\n        <div className=\"controller-option\">\n          *right click and drag to rotate camera\n        </div>\n      </Menu>\n    );\n  }\n}\n\nexport default controllerUrlManager( Controller );\n","import React from \"react\";\nimport DeckGL from \"deck.gl\";\nimport MapGL from \"react-map-gl\";\n\nimport history from \"./history\";\nimport { mapUrlManager } from \"./services/urlManagement.service\";\nimport Controller from \"./Components/Controller\";\n\nimport \"mapbox-gl/dist/mapbox-gl.css\";\nimport \"./App.css\";\n\n// Initial viewport settings\nconst initialViewState = {\n  longitude: 18.0686,\n  latitude: 59.3293,\n  zoom: 13,\n  pitch: 45,\n  bearing: 0\n};\n\nclass App extends React.Component {\n  static defaultProps = initialViewState;\n\n  constructor() {\n    super();\n\n    this.state = {\n      mapLayers: []\n    };\n  }\n\n  _onWebGLInitialized = gl => {\n    gl.enable(gl.DEPTH_TEST);\n    gl.depthFunc(gl.LEQUAL);\n    this.setState({ gl });\n  };\n\n  // _onMapLoad = () => {\n  // const map = this._map;\n  // const deck = this._deck;\n\n  // map.addLayer(buildingsLayer())\n  // map.addLayer(new MapboxLayer({ id: 'layer-abc', deck }));\n  // }\n\n  _onLayerChange = mapLayers => {\n    this.setState({ mapLayers });\n  };\n\n  _toolTipCallback = info => {\n    this.setState({\n      hoveredObject: info.object,\n      pointerX: info.x,\n      pointerY: info.y\n    });\n  };\n\n  _renderTooltip() {\n    const { hoveredObject, pointerX, pointerY } = this.state || {};\n    return (\n      hoveredObject && (\n        <div\n          style={{\n            position: \"absolute\",\n            zIndex: 1,\n            pointerEvents: \"none\",\n            left: pointerX,\n            top: pointerY,\n            color: \"green\",\n            backgroundColor: \"white\",\n            fontFamily: \"Open Sans\",\n            padding: 5\n          }}\n        >\n          {hoveredObject.message}\n        </div>\n      )\n    );\n  }\n\n  _updateUrl({ viewState }) {\n    console.log(viewState);\n    clearTimeout(this.urlTimer);\n\n    this.urlTimer = setTimeout(() => {\n      this.props.onChange(viewState);\n    }, 500);\n  }\n\n  componentDidMount() {\n    document\n      .getElementById(\"container\")\n      .addEventListener(\"contextmenu\", evt => evt.preventDefault());\n\n    history.listen(() => this.forceUpdate());\n  }\n\n  render() {\n    const { gl } = this.state;\n\n    const layers = this.state.mapLayers;\n\n    return (\n      <div id=\"container\">\n        <DeckGL\n          ref={ref => {\n            // save a reference to the Deck instance\n            this._deck = ref && ref.deck;\n          }}\n          onWebGLInitialized={this._onWebGLInitialized}\n          initialViewState={this.props}\n          onViewStateChange={viewport => this._updateUrl(viewport)}\n          controller={true}\n          layers={layers}\n        >\n          {gl && (\n            <MapGL\n              ref={ref => {\n                // save a reference to the mapboxgl.Map instance\n                this._map = ref && ref.getMap();\n              }}\n              mapboxApiAccessToken={process.env.REACT_APP_MAPBOX_ACCESS_TOKEN}\n              // gl={gl}\n              onLoad={this._onMapLoad}\n              mapStyle=\"mapbox://styles/mapbox/dark-v10\"\n              preventStyleDiffing={true}\n            />\n          )}\n          {this._renderTooltip()}\n        </DeckGL>\n\n        <Controller\n          onLayerChange={this._onLayerChange}\n          toolTipCallback={this._toolTipCallback}\n        />\n\n        <div className=\"footer\">\n          2019 -{\" \"}\n          <a\n            href=\"http://tylernwolf.com?ref=mobilityObserver\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            Tyler Wolf\n          </a>{\" \"}\n          and Adam Ekberg - Data Source:{\" \"}\n          <a\n            href=\"https://dataportalen.stockholm.se/dataportalen/\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            https://dataportalen.stockholm.se/dataportalen/\n          </a>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default mapUrlManager(App);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit http://bit.ly/CRA-PWA\"\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See http://bit.ly/CRA-PWA.\"\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport { configureUrlQuery } from 'react-url-query';\n\nimport history from './history';\n\nconfigureUrlQuery({ history });\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}